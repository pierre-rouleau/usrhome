# Sourced script: envfor-lisp-with-clasp  -*- mode: sh; -*-
#
# Purpose   : Set environment to be able to run Clasp via the 'lisp' command.
# Created   : Wednesday, February 11 2026.
# Author    : Pierre Rouleau <prouleau001@gmail.com>
# Time-stamp: <2026-02-18 16:59:25 EST, updated by Pierre Rouleau>
# ----------------------------------------------------------------------------
# Description
# -----------
#
#  Usage:   use-lisp-with-clasp
#
#    The command 'use-lisp-with-clasp' is an alias for this file.
#    You could also type: 'source envfor-lisp-with-clasp'
#
#  Impact:  Checks for presence of GNU clasp and sets the USRHOME_PGMFOR_LISP environment
#           variable used by the $USRHOME_DIR/bin/lisp script, which starts the selected
#           Common Lisp REPL properly.  The you can start GNU clasp by typing: lisp

# ----------------------------------------------------------------------------
#  Dependencies
#  ------------
#
# - clasp     see: https://clasp-developers.github.io/index.html
#
#  To install see: https://clasp-developers.github.io/download.html

# ----------------------------------------------------------------------------
# Script
# ------
#
#
pgm_name="$(basename "$0")"

print_usage()
{
    printf -- "
%s:  Select Clasp as Common Lisp executed by 'lisp'.

     - Ref: https://clasp-developers.github.io/

" "$pgm_name"
}

# Check validity of arguments
if [ "$1" = "--help" ] || [ "$1" = "-h" ]; then
    print_usage
    return 0
fi

# Proceed in setting it up.
#
if command -v clasp >/dev/null; then
    export USRHOME_PGMFOR_LISP=`which clasp`
    printf -- ". Using Common Lisp - %s - from %s\n" "$(clasp --version 2>/dev/null)" "$USRHOME_PGMFOR_LISP"
    if command -v rlwrap > /dev/null; then
        printf -- "   With %s to enhance REPL line editing and history.\n" "$(rlwrap -v)"
    else
        printf -- "   WARNING: rlwrap is not available.  Install it to enhance Clasp REPL.\n"
    fi
else
    printf -- "***ERROR*** Clasp is not in PATH!\n"
fi

# -----------------------------------------------------------------------------
